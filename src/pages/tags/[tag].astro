---
import { allTags } from "../../data/getAllTags";
import { issues } from "../../data/issues.js";
import BaseLayout from "../../layouts/BaseLayout.astro";

export async function getStaticPaths() {
    const allTasks = issues;

    return [...allTags].map(({ name, description, color }) => {
        const filteredTasks = allTasks.filter(({ labels }) =>
            labels.find((label: { name: String }) => label.name === name),
        );

        return {
            params: {
                tag: name,
            },
            props: {
                description: description,
                color: color,
                tasks: filteredTasks,
            },
        };
    });
}

const { tag } = Astro.params;
console.log(Astro.params);
const { tasks, description, color } = Astro.props;
console.log(Astro.props)
---

<BaseLayout header="Tags">
    <h1>{tag}</h1>
    <p>{description}</p>
    <ul>
        {
            tasks?.map(({ title, number }) => {
                return (
                    <li>
                        <a
                            href={`/tasks/${number}`}
                            class:list={["underline", `text-[#${color}]`]}
                        >
                            {title}
                        </a>
                    </li>
                );
            })
        }
    </ul>
</BaseLayout>
